---
- hosts: 'centos_hosts,redhat_hosts'
  remote_user: root
  become: true
  become_user: root

  tasks:

  - name: Run Yum update
    yum:
      name: "*"
      state: latest

  - name: Install open vm tools if this is a virtual machine
    when: ansible_virtualization_role == "guest"
    yum:
      name: open-vm-tools
      state: latest

  - name: Install common packages
    yum:
      name: "{{ packages }}"
    vars:
      packages:
      - bind-utils
      - cifs-utils
      - curl
      - epel-release
      - net-tools
      - nfs-utils
      - rsync
      - samba-client
      - wget

